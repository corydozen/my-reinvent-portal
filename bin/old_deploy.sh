cd cdk/assets/lambda/catalogactions && mkdir dev_node_modules -p && yarn --modules-folder dev_node_modules && rm -rf node_modules && cp dev_node_modules node_modules -r && cd ../../.. && yarn && yarn build && cd assets/lambda/catalogactions && mkdir prod_node_modules -p && yarn --prod --modules-folder prod_node_modules --frozen-lockfile && rm -rf node_modules && cp prod_node_modules node_modules -r && cd ../../../cdk && npx cdk synth && npx cdk deploy --all --profile ${2} --require-approval never && aws cloudformation describe-stacks --stack-name "${1}Output" --profile ${2} --region us-east-1 > cloudformationoutput.json && echo "export default {};" > ../src/config.ts && node parseCfOutput.js && cd .. && yarn && yarn build && cd cdk && npx cdk deploy "${1}S3" --profile ${2} --require-approval never --region us-east-1
